# Importing functions that we need.

from sys import exit
from random import randint
import random


# Defining some classes

class Clue(object):

    def enter(self):
        pass

class Weapon(Clue):
    def __init__(self, name):
        self.name = name

class Room(Clue):
    def __init__(self, name):
        self.name = name

class Suspect(Clue):
    def __init__(self, name):
        self.name = name

# Weapons
knife = Weapon("Knife")
candlestick = Weapon("Candlestick")
revolver = Weapon("Revolver")
wrench = Weapon("Wrench")
lead_pipe = Weapon("Lead Pipe")
rope = Weapon("Rope")

# Suspects
green = Suspect("Reverend Green")
scarlet = Suspect("Miss Scarlet")
plum = Suspect("Professor Plum")
white = Suspect("Mrs. White")
peacock = Suspect("Mrs. Peacock")
mustard = Suspect("Colonel Mustard")

# Rooms
kitchen = Room("Kitchen")
conservatory = Room("Conservatory")
library = Room("Library")
billiard_room = Room("Billiard Room")
hall = Room("Hall")
ballroom = Room("Ballroom")
study = Room("Study")
lounge = Room("Lounge")
dinning_room = Room("Dinning Room")

weapons = [knife, candlestick, revolver, wrench, rope, lead_pipe]

suspects = [green, scarlet, plum, white, peacock, mustard]

rooms = [kitchen, conservatory, library, billiard_room, hall, ballroom, study,
lounge, dinning_room]

available_clues = [knife, candlestick, revolver, wrench, rope, lead_pipe, green,
scarlet, plum, white, peacock, mustard, kitchen, conservatory, library,
billiard_room, hall, ballroom, study, lounge, dinning_room]



class Game(object):

    def intro(self):
        print "\nWelcome to Hayley's Text-Based Clue Game"
        print "This program will randomly select a murderer,"
        print "a crime scene, and a murder weapon.\n"
        print "It will then shuffle the remaining cards"
        print "and deal them to you, and two computer players.\n"
        print "You will be able to see your 'Detective Notebook'"
        print "where your clues will be noted, as well as the clues"
        print "you gather as you navigate the mansion.\n"
        print "Once you have gathered enough clues, make an accusation."
        print "If you correctly identify the murderer, weapon, and location"
        print "you will win the game. But be careful."
        print "Your computer opponents are trying to solve the mystery too."
        print "\n"


    def setup(self):

        self.murder_weapon = weapons[randint(0, len(weapons)-1)]
        self.crime_scene = rooms[randint(0, len(rooms)-1)]
        self.murderer = suspects[randint(0, len(suspects)-1)]

        # print self.murder_weapon.name
        # print self.crime_scene.name
        # print self.murderer.name

        available_clues.remove(self.murder_weapon)
        available_clues.remove(self.crime_scene)
        available_clues.remove(self.murderer)

        random.shuffle(available_clues)

        # Assemble player hand
        self.player_hand = []

        for n in range(0, 6):
            self.player_hand.append(available_clues[n])

        # Assemble computer player A's hand
        self.computer_a_hand = []

        for n in range(6, 12):
            self.computer_a_hand.append(available_clues[n])

        # Assemble computer player B's hand
        self.computer_b_hand = []

        for n in range(12, 18):
            self.computer_b_hand.append(available_clues[n])

        # Assemble a collection of gathered clues
        self.gathered_clues = []

        # Answers
        self.answers = []

    def detective_notebook(self):

        print "\n"

        for i in range(0, len(suspects)):
            if suspects[i] in self.player_hand:
                print "X  ", suspects[i].name
            elif suspects[i] in self.gathered_clues:
                print "C  ", suspects[i].name
            elif suspects[i] in self.answers:
                print "*  ", suspects[i].name
            else:
                print "   ", suspects[i].name

        print "\n"

        for i in range(0, len(weapons)):
            if weapons[i] in self.player_hand:
                print "X  ", weapons[i].name
            elif weapons[i] in self.gathered_clues:
                print "C  ", weapons[i].name
            elif weapons[i] in self.answers:
                print "*  ", weapons[i].name
            else:
                print "   ", weapons[i].name

        print "\n"

        for i in range(0, len(rooms)):
            if rooms[i] in self.player_hand:
                print "X  ", rooms[i].name
            elif rooms[i] in self.gathered_clues:
                print "C  ", rooms[i].name
            elif rooms[i] in self.answers:
                print "*  ", rooms[i].name
            else:
                print "   ", rooms[i].name

        print "\n"

    def move_explanation(self):

        print """We will move around the mansion a little differently
        than in the board game. You will 'roll' a dice. If you get
        a one or a two you will have one room randomly selected
        for you to travel to. If you roll a three or a four,
        you will get to pick between two randomly selected rooms.
        If you roll a five or a six, you will get to pick between
        three randomly selected rooms. If you are in the
        Conservatory, Study, Kitchen, or Lounge you will be given
        the option to use the secret passageway."""

    def player_move_first(self):

        roll = randint(0,5) + 1
        print "You rolled a %d" % roll

        if roll == 1 or roll == 2:
            next_room = rooms[randint(0, len(rooms)-1)]
            print "You proceed to %s" % next_room.name

        elif roll == 3 or roll == 4:

            option_a = rooms[randint(0, len(rooms)-1)]

            option_b = rooms[randint(0, len(rooms)-1)]

            if option_a != option_b:
                pass
            else:
                while option_a == option_b:
                    option_b = rooms[randint(0, len(rooms)-1)]

            print "You may go to the %s or the %s." % (option_a.name, option_b.name)
            print "To proceed to the %s, enter 1." % option_a.name
            print "To proceed to the %s, enter 2." % option_b.name

            selection = input("> ")

            if selection == 1:
                next_room = option_a
                print "You proceed to the %s." % option_a.name
            elif selection == 2:
                next_room = option_b
                print "You proceed to the %s." % option_b.name
            else:
                print "You entered an invalid key. I will select for you."
                next_room = option_a
                print "You proceed to the %s." % option_a.name

        else:

            option_a = rooms[randint(0, len(rooms)-1)]

            option_b = rooms[randint(0, len(rooms)-1)]

            if option_a != option_b:
                pass
            else:
                while option_a == option_b:
                    option_b = rooms[randint(0, len(rooms)-1)]

            option_c = rooms[randint(0, len(rooms)-1)]

            if option_c != option_a and option_c != option_b:
                pass
            else:
                while option_c == option_a or option_c == option_b:
                    option_c = rooms[randint(0, len(rooms)-1)]

            print "You may go to the %s, or the %s, or the %s." % (option_a.name, option_b.name, option_c.name)
            print "To proceed to the %s, enter 1." % option_a.name
            print "To proceed to the %s, enter 2." % option_b.name
            print "To proceed to the %s, enter 3." % option_c.name

            selection = input("> ")

            if selection == 1:
                next_room = option_a
                print "You proceed to the %s." % option_a.name
            elif selection == 2:
                next_room = option_b
                print "You proceed to the %s." % option_b.name
            elif selection == 3:
                next_room = option_c
                print "You proceed to the %s." % option_c.name
            else:
                print "You entered an invalid key. I will select for you."
                next_room = option_a
                print "You proceed to the %s." % option_a.name

        return next_room

    def player_guess(self, next_room):

        # this will allow the user to make a guess as to the suspect, weapon, and room.

        print "Make a guess! Select a suspect and a weapon. \n"
        print """

        1. Reverend Green
        2. Miss Scarlet
        3. Professor Plum
        4. Mrs. White
        5. Mrs. Peacock
        6. Colonel Mustard

        """
        selection = input("Input a number between 1 and 6, corresponding to your guess.  ")

        suspect_selection = suspects[selection - 1]

        print "\n You have selected %s." % suspect_selection.name

        print """

        1. Knife
        2. Candlestick
        3. Revolver
        4. Wrench
        5. Rope
        6. Lead Pipe

        """
        selection = input("Input a number between 1 and 6, corresponding to your guess.  ")

        weapon_selection = weapons[selection - 1]

        print "\n You have selected the %s." % weapon_selection.name

        print "You are in the %s." % next_room.name
        print "Is it %s, with the %s, in the %s?\n" % (suspect_selection.name, weapon_selection.name, next_room.name)

        # Now it will check against the computer player hands.

        check = randint(0,2)

        if check == 0:
            ans = "n"
            if suspect_selection in self.computer_a_hand:
                print "Computer Player A has %s in their hand." % suspect_selection.name
                self.gathered_clues.append(suspect_selection)
                ans = "y"
            elif weapon_selection in self.computer_a_hand:
                print "Computer Player A has %s in their hand." % weapon_selection.name
                self.gathered_clues.append(weapon_selection)
                ans = "y"
            elif next_room in self.computer_a_hand:
                print "Computer Player A has %s in their hand." % next_room.name
                self.gathered_clues.append(next_room)
                ans = "y"
        elif check == 1:
            if weapon_selection in self.computer_a_hand:
                print "Computer Player A has %s in their hand." % weapon_selection.name
                self.gathered_clues.append(weapon_selection)
                ans = "y"
            elif next_room in self.computer_a_hand:
                print "Computer Player A has %s in their hand." % next_room.name
                self.gathered_clues.append(next_room)
                ans = "y"
            elif suspect_selection in self.computer_a_hand:
                print "Computer Player A has %s in their hand." % suspect_selection.name
                self.gathered_clues.append(suspect_selection)
                ans = "y"

        else:
            if next_room in self.computer_a_hand:
                print "Computer Player A has %s in their hand." % next_room.name
                self.gathered_clues.append(next_room)
                ans = "y"
            elif suspect_selection in self.computer_a_hand:
                print "Computer Player A has %s in their hand." % suspect_selection.name
                self.gathered_clues.append(suspect_selection)
                ans = "y"
            elif weapon_selection in self.computer_a_hand:
                print "Computer Player A has %s in their hand."
                self.gathered_clues.append(weapon_selection)
                ans = "y"


        if ans == "y":
            pass
        else:
            if check == 0:
                if suspect_selection in self.computer_b_hand:
                    print "Computer Player B has %s in their hand." % suspect_selection.name
                    self.gathered_clues.append(self.suspect_selection)
                    ans = "y"
                elif weapon_selection in self.computer_b_hand:
                    print "Computer Player B has %s in their hand." % weapon_selection.name
                    self.gathered_clues.append(weapon_selection)
                    ans = "y"
                elif next_room in self.computer_b_hand:
                    print "Computer Player B has %s in their hand." % next_room.name
                    self.gathered_clues.append(next_room)
                    ans = "y"
            elif check == 1:
                if weapon_selection in self.computer_b_hand:
                    print "Computer Player B has %s in their hand." % weapon_selection.name
                    self.gathered_clues.append(weapon_selection)
                    ans = "y"
                elif next_room in self.computer_b_hand:
                    print "Computer Player B has %s in their hand." % next_room.name
                    self.gathered_clues.append(next_room)
                    ans = "y"
                elif suspect_selection in self.computer_b_hand:
                    print "Computer Player B has %s in their hand." % suspect_selection.name
                    self.gathered_clues.append(suspect_selection)
                    ans = "y"
            else:
                if next_room in self.computer_b_hand:
                    print "Computer Player B has %s in their hand." % next_room.name
                    self.gathered_clues.append(next_room)
                    ans = "y"
                elif suspect_selection in self.computer_b_hand:
                    print "Computer Player B has %s in their hand." % suspect_selection.name
                    self.gathered_clues.append(suspect_selection)
                    ans = "y"
                elif weapon_selection in self.computer_b_hand:
                    print "Computer Player B has %s in their hand."
                    self.gathered_clues.append(weapon_selection)
                    ans = "y"

        if ans == "y":
            pass
        else:
            print "Your guess did not return any clues from your opponents' hands."
            print "Would you like to mark any of the items down as the answer?"
            mark = raw_input("Type 'y' for yes and 'n' for no.  ")

            while mark == "y":
                print """ Do you want to indicate:
                1. The murder?
                2. The weapon?
                3. The crime scene?

                """
                solution = input("Enter number corresponding to your selection:  ")

                if solution == 1:
                    print """Who is the murderer?

                    1. Reverend Green
                    2. Miss Scarlet
                    3. Professor Plum
                    4. Mrs. White
                    5. Mrs. Peacock
                    6. Colonel Mustard

                    """
                    selection = input("Enter a number corresponding to your selection:  ")
                    self.answer.append(suspects[i])

                elif solution == 2:
                    print """What is the murder weapon?

                     1. Knife
                     2. Candlestick
                     3. Revolver
                     4. Wrench
                     5. Rope
                     6. Lead Pipe

                     """
                     selection = input("Enter a number corresponding to your selection:  ")
                     self.answer.append(weapons[i])

                else:
                    print """Where was the crime scene:

                    1. Kitchen
                    2. Conservatory
                    3. Library
                    4. Billiard Room
                    5. Hall
                    6. Ballroom
                    7. Study
                    8. Lounge
                    9. Dinning Room

                    """





a_game = Game()

a_game.intro()
a_game.setup()
a_game.detective_notebook()
next_room = a_game.player_move_first()
a_game.player_guess(next_room)
a_game.detective_notebook()
